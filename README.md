# 人工智能课程项目报告

## 项目概述

本项目包含四个完整的机器学习应用系统，涵盖回归与分类两大核心任务：
1. **项目一：城市二手房房价预测系统** (多元线性回归)
2. **项目二：电商产品销量预测系统** (Ridge回归与正则化)
3. **项目三：糖尿病预测系统** (二分类逻辑回归)
4. **项目四：手写数字识别系统** (多分类逻辑回归与OvA策略)

本项目的核心目标是掌握机器学习算法的底层数学原理（手动实现梯度下降、Sigmoid、正则化等）及其在实际业务中的分析应用。

**作者**: 王梓涵
**邮箱**: wangzh011031@163.com
**时间**: 2025年12月24日

## 项目结构

```
├── house_price_prediction.py              # 项目一：城市二手房房价预测系统
├── product_sales_prediction.py            # 项目二：电商产品销量预测系统
├── diabetes_prediction.py                 # 项目三：糖尿病预测系统
├── digit_recognition_prediction.py        # 项目四：手写数字识别系统
├── 房价预测系统分析报告.md                 # 项目一深度分析报告
├── 电商销量预测系统分析报告.md               # 项目二深度分析报告
├── 糖尿病预测系统分析报告.md               # 项目三深度分析报告
├── 手写数字识别系统分析报告.md               # 项目四深度分析报告
├── README.md                              # 项目说明文档
├── house_price_data/                      # 项目一数据保存目录
│   ├── plots/                            # 项目一图表文件
│   ├── training_data/                    # 项目一训练数据
│   ├── evaluation_data/                  # 项目一评估数据
│   └── feature_analysis/                 # 项目一特征分析数据
├── product_sales_data/                    # 项目二数据保存目录
│   ├── plots/                            # 项目二图表文件
│   ├── training_data/                    # 项目二训练数据
│   ├── evaluation_data/                  # 项目二评估数据
│   └── feature_analysis/                 # 项目二特征分析数据
├── diabetes_data/                         # 项目三数据保存目录
│   ├── plots/                            # 项目三图表文件
│   ├── training_data/                    # 项目三训练数据
│   ├── evaluation_data/                  # 项目三评估数据
│   └── feature_analysis/                 # 项目三特征分析数据
└── digit_recognition_data/                # 项目四数据保存目录
    ├── plots/                            # 项目四图表文件
    └── evaluation_data/                  # 项目四评估数据
```

---

## 项目一：城市二手房房价预测系统 (多元线性回归)

### 功能特性
- ✅ **数据预处理**：缺失值处理（2%缺失率模拟）、异常值处理（面积>200m²）、特征标准化
- ✅ **多元线性回归模型**：手动实现完整的线性回归算法
- ✅ **三种优化算法**：批量梯度下降(BGD)、随机梯度下降(SGD)、小批量梯度下降(MBGD)
- ✅ **收敛分析**：损失函数收敛曲线、收敛速度分析、算法性能对比
- ✅ **模型评估**：R²、MAE、MSE、RMSE指标计算
- ✅ **可视化分析**：12个丰富的分析图表，使用学术风格(SCI风格)

### 核心算法
- **假设函数**：

$$
y = w_0 + w_1 \cdot area + w_2 \cdot room\_num + w_3 \cdot living\_room\_num + w_4 \cdot floor + w_5 \cdot distance\_subway
$$

- **损失函数**：

$$
L(w) = \frac{1}{2m}\sum_{i=1}^m(y_i - \hat{y}_i)^2
$$

### 主要发现
1. **面积(area)**：正向影响最强的特征，面积越大房价越高。
2. **地铁距离(distance_subway)**：负向影响显著，距离越远房价越低。
3. **收敛对比**：BGD收敛稳定但较慢，SGD收敛快但震荡明显。

---

## 项目二：电商产品销量预测系统 (Ridge回归与正则化)

### 功能特性
- ✅ **时间特征提取**：从日期中提取月份(1-12)和星期(1-7)特征
- ✅ **特征相关性分析**：皮尔逊相关系数热力图和重要性排序
- ✅ **Ridge回归**：L2正则化防止过拟合
- ✅ **正则化调参**：λ值从0.01到100的性能对比分析
- ✅ **模型评估**：R²、RMSE指标，训练/验证/测试集分离
- ✅ **业务分析**：基于权重系数的运营策略建议

### 核心算法
- **假设函数**：

$$
sales = w_0 + w_1 \cdot price + w_2 \cdot promotion + w_3 \cdot ad\_spend + w_4 \cdot user\_rating + w_5 \cdot holiday + w_6 \cdot month + w_7 \cdot weekday
$$

- **损失函数**：

$$
L(w) = \frac{1}{2m}\sum_{i=1}^m(y_i - \hat{y}_i)^2 + \frac{\lambda}{2}\sum_{j=1}^n w_j^2
$$

### 主要发现
1. **广告投入(ad_spend)**：最重要因素，投入增加显著提升销量。
2. **价格(price)**：负相关，价格过高抑制销量。
3. **正则化效果**：λ=1.0在偏差-方差平衡中表现最佳。

---

## 项目三：糖尿病预测系统 (二分类基础)

### 功能特性
- ✅ **手动实现逻辑回归**：Sigmoid映射、交叉熵代价函数、梯度下降参数更新
- ✅ **深度分布解读**：基于年龄、BMI、血糖等维度的细粒度患病风险统计
- ✅ **决策边界可视化**：在二维特征空间绘制逻辑回归的分类边界
- ✅ **模型评估**：ROC曲线、AUC计算、混淆矩阵分析
- ✅ **对比实验**：手动实现版本与 `sklearn.linear_model.LogisticRegression` 的性能对齐

### 核心算法
- **Sigmoid函数**: $g(z) = \frac{1}{1 + e^{-z}}$
- **代价函数**: $J(w) = -\frac{1}{m} \sum [y \log(h) + (1-y) \log(1-h)]$

### 主要发现
1. **血糖 (Glucose)**：预测糖尿病的“金标准”，其权重系数远超其他特征。
2. **BMI 与 肥胖**：肥胖人群（BMI ≥ 30）的患病风险是非肥胖人群的 **6 倍以上**。
3. **年龄因素**：40-50 岁年龄段表现出最高的患病比例（约 55%）。

---

## 项目四：手写数字识别系统 (多分类拓展)

### 功能特性
- ✅ **One-vs-All 策略**：将多分类任务分解为 10 个独立的二分类逻辑回归分类器
- ✅ **L2 正则化**：手动推导正则化梯度公式，解决高维特征下的过拟合问题
- ✅ **权重可视化**：将分类器参数还原为 8x8 特征热图，展示模型“看”数字的逻辑
- ✅ **学习曲线分析**：探讨模型准确率随训练样本量增加的变化趋势
- ✅ **误分类剖析**：可视化预测错误的样本，挖掘线性模型的局限性

### 核心算法
- **正则化代价函数**: 
$$
J(w) = J_{orig}(w) + \frac{\lambda}{2m} \sum w_j^2
$$
- **多分类预测**: 
$$
\hat{y} = \arg\max_{i} P(y=i|X; \theta^{(i)})
$$

### 主要发现
1. **正则化效果**：λ=0.1 时在 MNIST 简化版数据集上达到了最佳的泛化性能。
2. **易混淆数字**：数字 1 与 8 存在最高的相互误判率，主因是部分书写风格的像素重叠。
3. **分类性能**：系统最终达到了 **96.11%** 的测试准确率。

---

## 技术栈

### 核心依赖
```
numpy>=1.21.0          # 数值计算
pandas>=1.3.0          # 数据处理
matplotlib>=3.4.0      # 可视化绘图
seaborn>=0.11.0        # 统计分析可视化
scikit-learn>=1.0.0    # 评估指标与数据集对比
scipy>=1.7.0           # 优化算法支持
```

---

## 使用方法

### 1. 环境配置
```bash
pip install numpy pandas matplotlib seaborn scikit-learn scipy
```

### 2. 运行项目
```bash
python house_price_prediction.py       # 项目一
python product_sales_prediction.py     # 项目二
python diabetes_prediction.py          # 项目三
python digit_recognition_prediction.py # 项目四
```

---

## 实验结果对比

| 项目 | 任务类型 | 核心模型 | 核心指标 |
| :--- | :--- | :--- | :--- |
| **房价预测** | 回归 | 多元线性回归 | R² = 0.99, RMSE = 7.86w |
| **销量预测** | 回归 | Ridge回归 (L2) | R² = 0.88, λ = 1.0 |
| **糖尿病预测** | 二分类 | 逻辑回归 (手动) | Accuracy = 71.4%, AUC = 0.82 |
| **手写数字识别** | 多分类 | OvA 逻辑回归 | Accuracy = 96.1%, λ = 0.1 |

---

## 业务建议

1. **房地产投资**：优先关注面积适中且地铁可达性高的房源。
2. **电商运营**：加大广告投入是提升销量的最有效手段，同时应在节假日配合促销。
3. **糖尿病预防**：建立基于血糖和 BMI 的早期预警系统，对 40 岁以上高危人群加强筛查。
4. **数字识别优化**：对于复杂书写体，建议引入多层感知机 (MLP) 或卷积神经网络 (CNN) 提升鲁棒性。
