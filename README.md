# 人工智能课程项目报告

## 项目概述

本项目包含四个完整的机器学习应用系统，涵盖回归与分类两大核心任务：
1. **项目一：城市二手房房价预测系统** (多元线性回归)
2. **项目二：电商产品销量预测系统** (Ridge回归与正则化)
3. **项目三：糖尿病预测系统** (二分类逻辑回归)
4. **项目四：手写数字识别系统** (多分类逻辑回归与OvA策略)

本项目的核心目标是掌握机器学习算法的底层数学原理（手动实现梯度下降、Sigmoid、正则化等）及其在实际业务中的分析应用。

**作者**: 王梓涵
**邮箱**: wangzh011031@163.com
**时间**: 2025年12月24日

## 项目结构

```
├── house_price_prediction.py              # 项目一：城市二手房房价预测系统
├── product_sales_prediction.py            # 项目二：电商产品销量预测系统
├── diabetes_prediction.py                 # 项目三：糖尿病预测系统
├── digit_recognition_prediction.py        # 项目四：手写数字识别系统
├── 房价预测系统分析报告.md                 # 项目一深度分析报告
├── 电商销量预测系统分析报告.md               # 项目二深度分析报告
├── 糖尿病预测系统分析报告.md               # 项目三深度分析报告
├── 手写数字识别系统分析报告.md               # 项目四深度分析报告
├── README.md                              # 项目说明文档
├── house_price_data/                      # 项目一数据与图表目录
├── product_sales_data/                    # 项目二数据与图表目录
├── diabetes_data/                         # 项目三数据与图表目录
└── digit_recognition_data/                # 项目四数据与图表目录
```

## 项目三：糖尿病预测系统 (二分类基础)

### 功能特性
- ✅ **手动实现逻辑回归**：Sigmoid映射、交叉熵代价函数、梯度下降参数更新
- ✅ **深度分布解读**：基于年龄、BMI、血糖等维度的细粒度患病风险统计
- ✅ **决策边界可视化**：在二维特征空间绘制逻辑回归的分类边界
- ✅ **模型评估**：ROC曲线、AUC计算、混淆矩阵分析
- ✅ **对比实验**：手动实现版本与 `sklearn.linear_model.LogisticRegression` 的性能对齐

### 核心算法
- **Sigmoid函数**: $g(z) = \frac{1}{1 + e^{-z}}$
- **代价函数**: $J(w) = -\frac{1}{m} \sum [y \log(h) + (1-y) \log(1-h)]$

### 主要发现
1. **血糖 (Glucose)**：预测糖尿病的“金标准”，其权重系数远超其他特征。
2. **BMI 与 肥胖**：肥胖人群（BMI ≥ 30）的患病风险是非肥胖人群的 **6 倍以上**。
3. **年龄因素**：40-50 岁年龄段表现出最高的患病比例（约 55%）。

## 项目四：手写数字识别系统 (多分类拓展)

### 功能特性
- ✅ **One-vs-All 策略**：将多分类任务分解为 10 个独立的二分类逻辑回归分类器
- ✅ **L2 正则化**：手动推导正则化梯度公式，解决高维特征下的过拟合问题
- ✅ **权重可视化**：将分类器参数还原为 8x8 特征热图，展示模型“看”数字的逻辑
- ✅ **学习曲线分析**：探讨模型准确率随训练样本量增加的变化趋势
- ✅ **误分类剖析**：可视化预测错误的样本，挖掘线性模型的局限性

### 核心算法
- **正则化代价函数**: $J(w) = J_{orig}(w) + \frac{\lambda}{2m} \sum w_j^2$
- **多分类预测**: $\hat{y} = \arg\max_{i} P(y=i|X; \theta^{(i)})$

### 主要发现
1. **正则化效果**：λ=0.1 时在 MNIST 简化版数据集上达到了最佳的泛化性能。
2. **易混淆数字**：数字 1 与 8 存在最高的相互误判率，主因是部分书写风格的像素重叠。
3. **分类性能**：系统最终达到了 **96.11%** 的测试准确率。

## 技术栈

### 核心依赖
```
numpy>=1.21.0          # 数值计算
pandas>=1.3.0          # 数据处理
matplotlib>=3.4.0      # 可视化绘图
seaborn>=0.11.0        # 统计分析可视化
scikit-learn>=1.0.0    # 评估指标与数据集对比
scipy>=1.7.0           # 优化算法支持
```

## 使用方法

### 1. 运行糖尿病预测 (项目三)
```bash
python diabetes_prediction.py
```
**重点输出**：`diabetes_data/plots/decision_boundary.png` (决策边界)

### 2. 运行手写数字识别 (项目四)
```bash
python digit_recognition_prediction.py
```
**重点输出**：`digit_recognition_data/plots/weights_vis.png` (权重热图)

## 实验结果对比

| 项目 | 任务类型 | 核心模型 | 核心指标 |
| :--- | :--- | :--- | :--- |
| **房价预测** | 回归 | 多元线性回归 | R² = 0.99, RMSE = 7.86w |
| **销量预测** | 回归 | Ridge回归 (L2) | R² = 0.88, λ = 1.0 |
| **糖尿病预测** | 二分类 | 逻辑回归 (手动) | Accuracy = 71.4%, AUC = 0.82 |
| **手写数字识别** | 多分类 | OvA 逻辑回归 | Accuracy = 96.1%, λ = 0.1 |

---

## 业务建议

### 糖尿病预防策略
1. **重点监控**：针对血糖 > 120 mg/dL 或 BMI > 30 的人群应建立高风险预警。
2. **筛查年龄**：建议从 30 岁起定期进行糖尿病专项筛查，尤其关注 40 岁后的风险陡增期。

### 识别系统优化
1. **非线性升级**：对于更复杂的手写体识别，建议将 OvA 逻辑回归升级为多层感知机 (MLP) 或卷积神经网络 (CNN)。
2. **特征工程**：引入边缘检测或 HOG 特征可进一步降低数字 1 和 8 的误识别率。
